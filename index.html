<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
  <title>Yet Another S4 Blog</title>
  <style>
    :root {
      --title-color: #bf5700; /* Change this to whatever color you want */
    }

    body {
      margin: 0;
      padding: 20px;
      font-family: Arial, sans-serif;
    }

    header h1 {
      color: var(--title-color);
      font-family: var(--title-font: Arial, sans-serif);
      text-align: center;
      font-size: 2.5em;
      margin-top: 20px;
    }

    article {
      max-width: 700px;
      margin: 40px auto;
      line-height: 1.6;
      color: #333;
    }

    h2 {
      font-size: 1.8em;
    }

    /* Ensure math equations are left-aligned */
    .math-center {
      text-align: left; /* Left-align the entire block */
      display: block;   /* Ensure it's treated as a block-level element */
      margin: 30px 0;
    }

    /* Additional specific targeting for MathJax rendered equations */
    .mjx-chtml {
      text-align: left !important; /* Force MathJax to align content left */
    }

    .mjx-math {
      text-align: left !important; /* Ensure MathJax equations are left-aligned */
    }
  </style>
</head>
<body>
  <header>
    <h1>Yet Another S4 Blog</h1>
  </header>

  <article>
    <h2>introduction</h2>
    <p>The aim of this blog is to concisely aid those who wish to learn the basic mathematical background of 
    and to learn how to implement the Structured State Space for Sequence Modeling (S4) architecture. This will be done
    in two sections: (1) mathematical background and (2) code implementation in Python and Pytorch.</p>
  </article>

  <article>
    <h2>mathematical background</h2>
    <p>The S4 architecture takes inspiration from the linear time invariant (LTI) dynamical system, where a hidden state is updated using
    data inputs, which is then used to evolve the system with linear operators.</p>

    <div class="math-center">
      \[
      \begin{aligned}
        h_{k+1} &= Ah_k + Bx_k \\
        \hat{x}_{k+1} &= Ch_{k+1} + Dx_k
      \end{aligned}
      \]
    </div>

    <p>Dimensions for the parameters are as follows:</p>
    <div class="math-center">
      \[
      \begin{aligned}
        &\Lambda \in \mathbb{C}^{h\times h}\text{ (diagonal matrix)} \\
        &P, Q \in \mathbb{C}^{h \times 1} \\
        &B, C \in \mathbb{C}^{h \times d}
      \end{aligned}
      \]
    </div>

    <p> Although many discretization methods exist, the Tustin discretization will be utilized for demonstration purposes. </p>
    <div class="math-center">
      \[
      \begin{aligned}
        \tilde{A} &= \Lambda - PQ^* \in \mathbb{C}^{h\times h} \\
        \bar{A} &= \left( I - \frac{\Delta}{2}\tilde{A}\right)^{-1}\left( I + \frac{\Delta}{2}\tilde{A}\right) \in \mathbb{C}^{h\times h} \\
        \tilde{C} &= \left( I - \bar{A}^L \right)^*C \in \mathbb{C}^{h\times d} \\
        z_w &= \text{exp}\left(-2\pi i \frac{w}{L}\right) \in \mathbb{C}^{L\times 1},\; w = 0,1,2,...,L-1 \\
        R_w &= \left( \frac{2}{\Delta}\frac{1-z_w}{1+z_w}-\Lambda \right)^{-1} \in \mathbb{C}^{h\times h} \\
        \mathcal{K}_w &= \frac{2}{1+z_w}\tilde{C}^*R_w\left(I-\frac{1}{1+\tilde{Q}R_w\tilde{P}}\tilde{P}\tilde{Q}^*R_w\right)B \in \mathbb{C}^{L\times d\times d} \\
        \bar{K} &= \text{real}\left(\text{iFFT}\left(\mathcal{K_w},\text{ axis = 0}\right)\right) \in \mathbb{R}^{L\times d \times d}
      \end{aligned} 
      \]
    </div>
  </article>

  <article>
    <h2>code implementation</h2>
    <p>Now that the math and logic have been established, a code implementation walkthrough will incorporate the above content
    to make a working S4 model.</p>
  </article>
</body>

<article>
    <h2> about the author</h2>
    <p> 
      My name is Austin Kwon. I am a Computational Science, Engineering, and Mathematics Ph.D student at 
      the Oden Institute at the University of Texas at Austin. My research interests include scientific 
      machine learning and digital twins. I am a graduate research assistant advised by Professor Tan Bui-Thanh in the .
      <a href="https://phoices.netlify.app/" target="_blank">PHO-ICES group</a>.
    </p>
  </article>

<div style="text-align: center;">
  <img src="oden_logo.png" alt="ODEN Logo" width="210">
</div>
</html>
