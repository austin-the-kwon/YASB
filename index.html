<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
  <title>Yet Another S4 Blog</title>
  <style>
    :root {
      --title-color: #bf5700; /* Change this to whatever color you want */
    }

    body {
      margin: 0;
      padding: 20px;
      font-family: Arial, sans-serif;
    }

    header h1 {
      color: var(--title-color);
      font-family: var(--title-font: Arial, sans-serif);
      text-align: center;
      font-size: 2.5em;
      margin-top: 20px;
    }

    article {
      max-width: 700px;
      margin: 40px auto;
      line-height: 1.6;
      color: #333;
    }

    a {
    color: #00A9B7; /* Set your desired color */
    text-decoration: underline; /* Optional: removes underline */
    }

    h2 {
      font-size: 1.8em;
    }

    /* Ensure math equations are left-aligned */
    .math-center {
      text-align: left; /* Left-align the entire block */
      display: block;   /* Ensure it's treated as a block-level element */
      margin: 30px 0;
    }

    /* Additional specific targeting for MathJax rendered equations */
    .mjx-chtml {
      text-align: left !important; /* Force MathJax to align content left */
    }

    .mjx-math {
      text-align: left !important; /* Ensure MathJax equations are left-aligned */
    }
  </style>
</head>
<body>
  <header>
    <h1>Yet Another S4 Blog</h1>
  </header>

  <article>
    <h2>Introduction</h2>
    <p>The aim of this blog is to concisely aid those who wish to learn the basic mathematical background of 
    and to learn how to implement the Structured State Space for Sequence Modeling (S4) architecture. This will be done
    in two sections: (1) mathematical background and (2) code implementation in Python and Pytorch.</p>
  </article>

  <article>
    <h2>Mathematical Background</h2>
    <p>The S4 architecture takes inspiration from the linear time invariant (LTI) dynamical system, where a hidden state is updated using
    data inputs, which is then used to evolve the system with linear operators.</p>

    <div class="math-center">
      \[
      \begin{aligned}
        h_{k+1} &= Ah_k + Bx_k \\
        \hat{x}_{k+1} &= Ch_{k+1} + Dx_k
      \end{aligned}
      \]
    </div>

    <p>Dimensions for the parameters are as follows:</p>
    <div class="math-center">
      \[
      \begin{aligned}
        &\Lambda \in \mathbb{C}^{h\times h}\text{ (diagonal matrix)} \\
        &P, Q \in \mathbb{C}^{h \times 1} \\
        &B, C \in \mathbb{C}^{h \times d}
      \end{aligned}
      \]
    </div>

    <p> Although many discretization methods exist, the Tustin discretization will be utilized for demonstration purposes. </p>
    <div class="math-center">
      \[
      \begin{aligned}
        &\hat{A} = \Lambda - \hat{P}\hat{Q}^* \in \mathbb{C}^{h\times h} \\
        &\bar{A} = \left( I - \frac{\Delta}{2}\hat{A}\right)^{-1}\left( I + \frac{\Delta}{2}\hat{A}\right) \in \mathbb{C}^{h\times h} \\
        &\tilde{C} = \left( I - \bar{A}^\ell \right)^*\hat{C} \in \mathbb{C}^{h\times d} \\
        &\text{for w = 1, 2, ..., L-1:}\\
        &\;\;\;\;z[w] = \text{exp}\left(-2\pi i \frac{w}{L}\right) \in \mathbb{C}^{1},\;\;\left(z\in\mathbb{C}^{\ell \times 1}\right) \\
        &\;\;\;\;R[w] = \left( \frac{2}{\Delta}\frac{1-z[w]}{1+z[w]}-\Lambda \right)^{-1} \in \mathbb{C}^{h\times h}
          ,\;\;\left(R\in\mathbb{C}^{\ell \times h \times h}\right)  \\
        &\;\;\;\;\mathcal{K}[w] = \frac{2}{1+z[w]}\tilde{C}^*R[w]\left(I-\frac{1}{1+\hat{Q}R[w]\hat{P}}\hat{P}\hat{Q}^*R[w]\right)\hat{B} 
          \in \mathbb{C}^{d\times d},\;\;\left(\mathcal{K}\in\mathbb{C}^{\ell\times d\times d}\right) \\
        &\bar{K} = \text{real}\left(\text{iFFT}\left(\mathcal{K_w},\text{ axis = 0}\right)\right) \in \mathbb{R}^{\ell\times d \times d}
      \end{aligned} 
      \]
    </div>
  </article>

  <article>
    <h2>Code Implementation</h2>
    <p>Now that the math and logic have been established, a code implementation walkthrough will incorporate the above content
    to make a working S4 model.</p>
  </article>
</body>

<article>
    <h2> About the Author</h2>
    <p> 
      My name is Austin Kwon. I am a Computational Science, Engineering, and Mathematics Ph.D student at 
      the <a href = "https://oden.utexas.edu/" target = "_black">Oden Institute</a> at the 
      <a href = "https://www.utexas.edu/" target = "_black">University of Texas at Austin</a>. My research 
      interests include scientific machine learning and digital twins. I am a graduate research assistant 
      advised by Professor Tan Bui-Thanh in the <a href="https://phoices.netlify.app/" target="_blank">PHO-ICES group</a>. 
      I received my BS in Aerospace and Mechanical Engineering at 
      <a href="https://www.rpi.edu/" target="_blank">Rensselaer Polytechnic Institute</a> in 2024.
      Any questions can be directed to austin.kwon@utexas.edu.
    </p>
  </article>

<div style="text-align: center;">
  <img src="oden_logo.png" alt="ODEN Logo" width="210">
</div>
</html>
